# Yokai Segmentation Tool

Grounded-Segment-Anythingを用いた妖怪画像セグメンテーションツールです。
クラウドGPU環境での運用を想定しており、GradioによるWeb UIを提供します。

## ディレクトリ構成

- `src/`: ソースコード
- `inputs/`: ここに処理したい画像(jpg, png)を入れてください（4000枚程度を想定）
- `outputs/`: セグメンテーション後の透過PNGが保存されます
- `processed/`: 処理が終わった元画像がここに移動されます
- `checkpoints/`: モデルの重みファイル

## セットアップ

1. 必要なリポジトリとモデルを準備します。
   ```bash
   bash setup.sh
   ```

2. 依存ライブラリをインストールします。
   ```bash
   pip install -r requirements.txt
   ```
   (注意: Grounded-Segment-Anythingの依存関係もインストールする必要があります。`setup.sh`内で案内しています)

## 使い方

1. `inputs/` ディレクトリに画像を配置します。
2. アプリケーションを起動します。
   ```bash
   python src/app.py
   ```
3. 表示されるURL (Gradio) にブラウザでアクセスします。
4. 画像が表示されると、デフォルトプロンプト（`yokai, 妖怪, おばけ, 幽霊, ghost`）で自動的にセグメンテーション結果が生成されます。結果を確認し、「Save & Next」または「Skip」を選択します。必要に応じてプロンプトを編集し、再実行してください。

## 機能
- **テキストプロンプト**: デフォルトで `yokai, 妖怪, おばけ, 幽霊, ghost` を設定。任意に編集可能。
- **自動実行**: 新しい画像が読み込まれるたびに現在のプロンプトで自動実行されるため、基本操作は「承認（Save）」か「否認（Skip）」のみです。
- **キュー管理**: Skipした画像はキューの最後尾に回されます。
- **自動保存・移動**: 保存時に自動的にファイルを移動し、整理します。

